"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1515],{1515:(B,v,c)=>{c.r(v),c.d(v,{HomePageModule:()=>Y});var g=c(8434),a=c(3092),k=c(4341),f=c(9262),u=c(467),P=c(8359);class x extends P.yU{constructor(n,s){super()}schedule(n,s=0){return this}}const p={setInterval(o,n,...s){const{delegate:i}=p;return null!=i&&i.setInterval?i.setInterval(o,n,...s):setInterval(o,n,...s)},clearInterval(o){const{delegate:n}=p;return((null==n?void 0:n.clearInterval)||clearInterval)(o)},delegate:void 0};var M=c(7908);const b={now:()=>(b.delegate||Date).now(),delegate:void 0};class d{constructor(n,s=d.now){this.schedulerActionCtor=n,this.now=s}schedule(n,s=0,i){return new this.schedulerActionCtor(this,n).schedule(i,s)}}d.now=b.now;const S=new class w extends d{constructor(n,s=d.now){super(n,s),this.actions=[],this._active=!1}flush(n){const{actions:s}=this;if(this._active)return void s.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=s.shift());if(this._active=!1,i){for(;n=s.shift();)n.unsubscribe();throw i}}}(class C extends x{constructor(n,s){super(n,s),this.scheduler=n,this.work=s,this.pending=!1}schedule(n,s=0){var i;if(this.closed)return this;this.state=n;const e=this.id,r=this.scheduler;return null!=e&&(this.id=this.recycleAsyncId(r,e,s)),this.pending=!0,this.delay=s,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(r,this.id,s),this}requestAsyncId(n,s,i=0){return p.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,s,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return s;null!=s&&p.clearInterval(s)}execute(n,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,s);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,s){let e,i=!1;try{this.work(n)}catch(r){i=!0,e=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),e}unsubscribe(){if(!this.closed){const{id:n,scheduler:s}=this,{actions:i}=s;this.work=this.state=this.scheduler=null,this.pending=!1,(0,M.o)(i,this),null!=n&&(this.id=this.recycleAsyncId(s,n,null)),this.delay=null,super.unsubscribe()}}}),I=S;var F=c(1985),T=c(9470);const y=(0,c(5083).F3)("Network",{web:()=>c.e(3780).then(c.bind(c,3780)).then(o=>new o.NetworkWeb)});var h=c(8244),t=c(1360),E=c(2497);const H=o=>({active:o});function R(o,n){if(1&o&&(t.j41(0,"div"),t.EFF(1),t.nI1(2,"number"),t.k0s()),2&o){const s=t.XpG(2);t.R7$(),t.SpI("Accuracy: ",t.i5U(2,1,s.currentLocation.accuracy,"1.1-1"),"m")}}function j(o,n){if(1&o&&(t.j41(0,"div",19)(1,"div",20)(2,"div"),t.EFF(3),t.nI1(4,"number"),t.k0s(),t.j41(5,"div"),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.DNE(8,R,3,4,"div",18),t.k0s()()),2&o){const s=t.XpG();t.R7$(3),t.SpI("Lat: ",t.i5U(4,3,s.currentLocation.latitude,"1.6-6"),""),t.R7$(3),t.SpI("Lng: ",t.i5U(7,6,s.currentLocation.longitude,"1.6-6"),""),t.R7$(2),t.Y8G("ngIf",s.currentLocation.accuracy)}}function $(o,n){1&o&&(t.j41(0,"div",21),t.nrm(1,"ion-icon",22),t.j41(2,"div",23)(3,"h3"),t.EFF(4,"Location Services Disabled"),t.k0s(),t.j41(5,"p"),t.EFF(6,"Please enable location services in your device settings to use this app properly."),t.k0s()()())}function z(o,n){if(1&o&&(t.j41(0,"div",24),t.EFF(1),t.k0s()),2&o){const s=t.XpG();t.R7$(),t.SpI(" ",s.isBackgroundTracking?"Background mode active":"Foreground tracking"," ")}}function G(o,n){if(1&o&&(t.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),t.EFF(3,"Current Session"),t.k0s()(),t.j41(4,"ion-card-content")(5,"ion-grid")(6,"ion-row")(7,"ion-col",25)(8,"div",26)(9,"div",27),t.EFF(10,"Distance"),t.k0s(),t.j41(11,"div",28),t.EFF(12),t.nI1(13,"number"),t.k0s()()(),t.j41(14,"ion-col",25)(15,"div",26)(16,"div",27),t.EFF(17,"Duration"),t.k0s(),t.j41(18,"div",28),t.EFF(19),t.k0s()()()()()()()),2&o){const s=t.XpG();t.R7$(12),t.SpI("",t.i5U(13,2,s.locationStats.totalDistance/1e3,"1.2-2")," km"),t.R7$(7),t.JRh(s.formatDuration(s.locationStats.totalTime))}}const N=[{path:"",component:(()=>{var o;class n{constructor(i,e){this.locationService=i,this.alertController=e,this.currentLocation=null,this.locationHistory=[],this.locationStats={totalDistance:0,totalTime:0},this.isTracking=!1,this.isBackgroundTracking=!1,this.locationServicesDisabled=!1,this.locationServicesAlertShown=!1,this.settingsSubscription=null,this.historySubscription=null,this.statsSubscription=null,this.locationUpdateSubscription=null,this.locationServicesSubscription=null,this.map=null,this.marker=null,this.accuracyCircle=null}ngOnInit(){var i=this;this.checkAndRequestPermissionsGently(),this.settingsSubscription=this.locationService.getSettings().subscribe(e=>{this.isTracking=e.isTrackingEnabled,this.isBackgroundTracking=e.isBackgroundTrackingEnabled}),this.historySubscription=this.locationService.getLocationHistory().subscribe(e=>{this.locationHistory=e,e.length>0&&(this.currentLocation=e[e.length-1],this.updateMapMarker())}),this.statsSubscription=this.locationService.getLocationStats().subscribe(e=>{this.locationStats=e}),this.locationServicesSubscription=this.locationService.getLocationServicesStatus().subscribe(function(){var e=(0,u.A)(function*(r){i.locationServicesDisabled=!r,r||i.locationServicesAlertShown?r&&(i.locationServicesAlertShown=!1):(i.locationServicesAlertShown=!0,yield i.showLocationServicesAlert())});return function(r){return e.apply(this,arguments)}}()),this.locationUpdateSubscription=function D(o=0,n=S){return o<0&&(o=0),function O(o=0,n,s=I){let i=-1;return null!=n&&((0,T.m)(n)?s=n:i=n),new F.c(e=>{let r=function L(o){return o instanceof Date&&!isNaN(o)}(o)?+o-s.now():o;r<0&&(r=0);let l=0;return s.schedule(function(){e.closed||(e.next(l++),0<=i?this.schedule(void 0,i):e.complete())},r)})}(o,o,n)}(1e4).subscribe((0,u.A)(function*(){if((yield i.locationService.checkLocationPermissions())&&!i.isTracking)try{const r=yield i.locationService.getCurrentPosition();r&&(i.currentLocation=r,i.updateMapMarker(),i.locationServicesDisabled=!1)}catch(r){console.error("Error updating current position:",r),i.locationServicesDisabled=!0}})),y.addListener("networkStatusChange",e=>{e.connected&&console.log("Network connected, syncing data if needed")})}ngAfterViewInit(){setTimeout(()=>{this.initMap()},500)}ngOnDestroy(){this.settingsSubscription&&(this.settingsSubscription.unsubscribe(),this.settingsSubscription=null),this.historySubscription&&(this.historySubscription.unsubscribe(),this.historySubscription=null),this.statsSubscription&&(this.statsSubscription.unsubscribe(),this.statsSubscription=null),this.locationUpdateSubscription&&(this.locationUpdateSubscription.unsubscribe(),this.locationUpdateSubscription=null),this.locationServicesSubscription&&(this.locationServicesSubscription.unsubscribe(),this.locationServicesSubscription=null),y.removeAllListeners(),this.map&&(this.map.remove(),this.map=null)}toggleTracking(){var i=this;return(0,u.A)(function*(){if(i.isTracking)yield i.locationService.stopTracking();else{if(!(yield i.locationService.checkLocationPermissions())&&!(yield i.locationService.requestLocationPermissions()))return void console.error("Location permissions denied");(yield i.locationService.startTracking())||console.error("Failed to start tracking")}})()}formatDuration(i){const e=Math.floor(i/3600),r=Math.floor(i%3600/60);let m="";return e>0&&(m+=`${e}h `),(r>0||e>0)&&(m+=`${r}m `),m+=`${Math.floor(i%60)}s`,m}initMap(){try{console.log("Initializing map...");const i=[0,0],e=document.getElementById("current-map");if(!e)return void console.error("Map element not found!");console.log("Map element found:",e),this.map&&this.map.remove(),this.map=h.map("current-map",{center:i,zoom:3,attributionControl:!0}),h.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(this.map);const r=h.divIcon({className:"custom-div-icon",html:'<div style="background-color:#2979FF;width:16px;height:16px;border-radius:50%;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]});try{this.marker=h.marker(i,{icon:r}).addTo(this.map)}catch(l){console.error("Failed to create marker:",l)}setTimeout(()=>{var l;null===(l=this.map)||void 0===l||l.invalidateSize()},100),this.updateCurrentPosition()}catch(i){console.error("Error initializing map:",i)}}updateCurrentPosition(){var i=this;return(0,u.A)(function*(){try{const e=yield i.locationService.getCurrentPosition();e?(i.currentLocation=e,i.updateMapMarker(),i.locationServicesDisabled=!1):i.locationServicesDisabled=!0}catch(e){console.error("Error getting current position:",e),i.locationServicesDisabled=!0}})()}updateMapMarker(){if(!this.map||!this.marker||!this.currentLocation)return;const i=[this.currentLocation.latitude,this.currentLocation.longitude];this.marker.setLatLng(i),this.map.setView(i,15),this.currentLocation.accuracy&&(this.accuracyCircle&&this.map.removeLayer(this.accuracyCircle),this.accuracyCircle=h.circle(i,{radius:this.currentLocation.accuracy,color:"#4285F4",fillColor:"#4285F4",fillOpacity:.2,weight:1}).addTo(this.map))}checkAndRequestPermissionsGently(){var i=this;return(0,u.A)(function*(){try{const e=yield i.locationService.checkLocationPermissions();console.log("Location permissions status:",e?"Granted":"Not granted");try{yield i.updateCurrentPosition()}catch(r){console.error("Error checking location services:",r),i.locationServicesDisabled=!0}}catch(e){console.error("Error checking permissions:",e),i.locationServicesDisabled=!0}})()}showLocationServicesAlert(){var i=this;return(0,u.A)(function*(){const e=yield i.alertController.create({header:"Location Services Disabled",message:"This app requires location services to function properly. Please enable location services in your device settings.",buttons:[{text:"OK",role:"cancel"}],backdropDismiss:!1});yield e.present(),yield e.onDidDismiss(),i.locationServicesAlertShown=!1})()}}return(o=n).\u0275fac=function(i){return new(i||o)(t.rXU(E.N),t.rXU(a.hG))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-home"]],standalone:!1,decls:32,vars:13,consts:[["color","primary"],["slot","start"],[1,"ion-padding"],[1,"map-container"],["id","current-map",2,"width","100%","height","40vh"],["class","map-overlay",4,"ngIf"],["class","location-services-warning",4,"ngIf"],[1,"status-container"],[1,"status-icon",3,"ngClass"],["name","locate"],[1,"status-label"],["class","status-details",4,"ngIf"],["expand","block",3,"click","color"],["slot","start",3,"name"],["expand","block","color","primary","routerLink","/settings"],["slot","start","name","settings"],["expand","block","color","tertiary","routerLink","/history",3,"disabled"],["slot","start","name","map"],[4,"ngIf"],[1,"map-overlay"],[1,"coordinates"],[1,"location-services-warning"],["name","warning"],[1,"warning-message"],[1,"status-details"],["size","6"],[1,"stat-container"],[1,"stat-label"],[1,"stat-value"]],template:function(i,e){1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-menu-button"),t.k0s(),t.j41(4,"ion-title"),t.EFF(5," Location Tracker "),t.k0s()()(),t.j41(6,"ion-content",2)(7,"div",3),t.nrm(8,"div",4),t.DNE(9,j,9,9,"div",5)(10,$,7,0,"div",6),t.k0s(),t.j41(11,"ion-card")(12,"ion-card-header")(13,"ion-card-title"),t.EFF(14,"Tracking Status"),t.k0s()(),t.j41(15,"ion-card-content")(16,"div",7)(17,"div",8),t.nrm(18,"ion-icon",9),t.k0s(),t.j41(19,"div",10),t.EFF(20),t.k0s(),t.DNE(21,z,2,1,"div",11),t.k0s(),t.j41(22,"ion-button",12),t.bIt("click",function(){return e.toggleTracking()}),t.nrm(23,"ion-icon",13),t.EFF(24),t.k0s(),t.j41(25,"ion-button",14),t.nrm(26,"ion-icon",15),t.EFF(27," Settings "),t.k0s(),t.j41(28,"ion-button",16),t.nrm(29,"ion-icon",17),t.EFF(30),t.k0s()()(),t.DNE(31,G,20,5,"ion-card",18),t.k0s()),2&i&&(t.R7$(9),t.Y8G("ngIf",e.currentLocation),t.R7$(),t.Y8G("ngIf",e.locationServicesDisabled),t.R7$(7),t.Y8G("ngClass",t.eq3(11,H,e.isTracking)),t.R7$(3),t.SpI(" ",e.isTracking?"Tracking Enabled":"Tracking Disabled"," "),t.R7$(),t.Y8G("ngIf",e.isTracking),t.R7$(),t.Y8G("color",e.isTracking?"danger":"success"),t.R7$(),t.Y8G("name",e.isTracking?"stop-circle":"play"),t.R7$(),t.SpI(" ",e.isTracking?"Stop Tracking":"Start Tracking"," "),t.R7$(4),t.Y8G("disabled",!(e.locationHistory&&e.locationHistory.length>0)),t.R7$(2),t.SpI(" View History (",e.locationHistory.length," points) "),t.R7$(),t.Y8G("ngIf",e.locationStats.totalDistance>0))},dependencies:[g.YU,g.bT,a.Jm,a.QW,a.b_,a.I9,a.ME,a.tN,a.hU,a.W9,a.lO,a.eU,a.iq,a.MC,a.ln,a.BC,a.ai,a.N7,f.Wk,g.QX],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}#current-map[_ngcontent-%COMP%]{height:40vh!important;width:100%!important;z-index:1}.map-container[_ngcontent-%COMP%]{position:relative;width:100%;height:40vh;margin-bottom:16px;border-radius:8px;overflow:hidden;box-shadow:0 4px 6px #0000001a}.map-overlay[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;background-color:#fffc;padding:5px 10px;border-radius:4px;font-size:12px;pointer-events:none;z-index:2}.location-services-warning[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:#000000b3;z-index:3;text-align:center;padding:1rem}.location-services-warning[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:var(--ion-color-warning);margin-bottom:16px}.location-services-warning[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;font-size:18px;margin-bottom:8px}.location-services-warning[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fffc;font-size:14px}.coordinates[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.status-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:16px}.status-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:var(--ion-color-light);display:flex;align-items:center;justify-content:center;margin-bottom:8px}.status-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;color:var(--ion-color-medium)}.status-icon.active[_ngcontent-%COMP%]{background-color:var(--ion-color-success)}.status-icon.active[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff}.status-label[_ngcontent-%COMP%]{font-weight:700;font-size:18px;color:var(--ion-color-dark)}.status-details[_ngcontent-%COMP%]{font-size:14px;color:var(--ion-color-medium);margin-top:4px}.stat-container[_ngcontent-%COMP%]{text-align:center;padding:8px}.stat-label[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:14px;margin-bottom:4px}.stat-value[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:var(--ion-color-dark)}"]}),n})()}];let U=(()=>{var o;class n{}return(o=n).\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[f.iI.forChild(N),f.iI]}),n})(),Y=(()=>{var o;class n{}return(o=n).\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[g.MD,k.YN,a.bv,U]}),n})()}}]);